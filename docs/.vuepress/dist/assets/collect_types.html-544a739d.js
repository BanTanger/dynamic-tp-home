import{_ as s,X as n,Y as a,a1 as t}from"./framework-a915a7eb.js";const o={},e=t(`<h3 id="采集类型" tabindex="-1"><a class="header-anchor" href="#采集类型" aria-hidden="true">#</a> 采集类型</h3><p>目前框架提供了四种监控数据采集方式，通过 collectorTypes 属性配置监控指标采集类型，默认 Micrometer</p><blockquote><ol><li><p>Logging：线程池指标数据会以 Json 格式输出到指定的日志文件里</p></li><li><p>Internal_logging：线程池指标数据会以 Json 格式输出到项目日志文件里</p></li><li><p>Micrometer：采用监控门面，通过引入相关 Micrometer 依赖采集到相应的存储平台里（如 Prometheus，InfluxDb...）</p></li><li><p>Endpoint：暴露 Endpoint 端点，可以通过 http 方式实时获取指标数据</p></li></ol></blockquote><h3 id="micrometer" tabindex="-1"><a class="header-anchor" href="#micrometer" aria-hidden="true">#</a> micrometer</h3><p>引入 prometheus（也可以用其他） 对应依赖，job 配置后 prometheus 管理台看到如下图所示，说明已经开始正常采集指标配置</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/435f0a69790946f8bff7761c40a0a0db~tplv-k3u1fbpfcp-zoom-1.image" alt="采集指标"></p><h3 id="logging" tabindex="-1"><a class="header-anchor" href="#logging" aria-hidden="true">#</a> logging</h3><p>指标数据以 json 日志格式输出磁盘，地址 \${logPath}/dynamictp/\${appName}.monitor.log</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">{</span><span class="token string">&quot;datetime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-04-17 11:35:15.208&quot;</span>, <span class="token string">&quot;app_name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;dynamic-tp-nacos-cloud-demo&quot;</span>, <span class="token string">&quot;thread_pool_metrics&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;activeCount&quot;</span>:0,<span class="token string">&quot;queueSize&quot;</span>:0,<span class="token string">&quot;largestPoolSize&quot;</span>:0,<span class="token string">&quot;poolSize&quot;</span>:0,<span class="token string">&quot;rejectHandlerName&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;CallerRunsPolicy&quot;</span>,<span class="token string">&quot;queueCapacity&quot;</span>:2000,<span class="token string">&quot;fair&quot;</span>:false,<span class="token string">&quot;queueTimeoutCount&quot;</span>:0,<span class="token string">&quot;rejectCount&quot;</span>:0,<span class="token string">&quot;waitTaskCount&quot;</span>:0,<span class="token string">&quot;taskCount&quot;</span>:0,<span class="token string">&quot;runTimeoutCount&quot;</span>:0,<span class="token string">&quot;queueRemainingCapacity&quot;</span>:2000,<span class="token string">&quot;corePoolSize&quot;</span>:4,<span class="token string">&quot;queueType&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;VariableLinkedBlockingQueue&quot;</span>,<span class="token string">&quot;completedTaskCount&quot;</span>:0,<span class="token string">&quot;dynamic&quot;</span>:true,<span class="token string">&quot;maximumPoolSize&quot;</span>:6,<span class="token string">&quot;poolName&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;dtpExecutor1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;datetime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-04-17 11:35:15.209&quot;</span>, <span class="token string">&quot;app_name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;dynamic-tp-nacos-cloud-demo&quot;</span>, <span class="token string">&quot;thread_pool_metrics&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;activeCount&quot;</span>:0,<span class="token string">&quot;queueSize&quot;</span>:0,<span class="token string">&quot;largestPoolSize&quot;</span>:0,<span class="token string">&quot;poolSize&quot;</span>:0,<span class="token string">&quot;rejectHandlerName&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;CallerRunsPolicy&quot;</span>,<span class="token string">&quot;queueCapacity&quot;</span>:2000,<span class="token string">&quot;fair&quot;</span>:false,<span class="token string">&quot;queueTimeoutCount&quot;</span>:0,<span class="token string">&quot;rejectCount&quot;</span>:0,<span class="token string">&quot;waitTaskCount&quot;</span>:0,<span class="token string">&quot;taskCount&quot;</span>:0,<span class="token string">&quot;runTimeoutCount&quot;</span>:0,<span class="token string">&quot;queueRemainingCapacity&quot;</span>:2000,<span class="token string">&quot;corePoolSize&quot;</span>:2,<span class="token string">&quot;queueType&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;TaskQueue&quot;</span>,<span class="token string">&quot;completedTaskCount&quot;</span>:0,<span class="token string">&quot;dynamic&quot;</span>:true,<span class="token string">&quot;maximumPoolSize&quot;</span>:4,<span class="token string">&quot;poolName&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;dtpExecutor2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;datetime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-04-17 11:35:15.209&quot;</span>, <span class="token string">&quot;app_name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;dynamic-tp-nacos-cloud-demo&quot;</span>, <span class="token string">&quot;thread_pool_metrics&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;activeCount&quot;</span>:0,<span class="token string">&quot;queueSize&quot;</span>:0,<span class="token string">&quot;largestPoolSize&quot;</span>:0,<span class="token string">&quot;poolSize&quot;</span>:0,<span class="token string">&quot;queueCapacity&quot;</span>:2147483647,<span class="token string">&quot;fair&quot;</span>:false,<span class="token string">&quot;queueTimeoutCount&quot;</span>:0,<span class="token string">&quot;rejectCount&quot;</span>:0,<span class="token string">&quot;waitTaskCount&quot;</span>:0,<span class="token string">&quot;taskCount&quot;</span>:0,<span class="token string">&quot;runTimeoutCount&quot;</span>:0,<span class="token string">&quot;queueRemainingCapacity&quot;</span>:2147483647,<span class="token string">&quot;corePoolSize&quot;</span>:1,<span class="token string">&quot;queueType&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;LinkedBlockingQueue&quot;</span>,<span class="token string">&quot;completedTaskCount&quot;</span>:0,<span class="token string">&quot;dynamic&quot;</span>:false,<span class="token string">&quot;maximumPoolSize&quot;</span>:1,<span class="token string">&quot;poolName&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;commonExecutor&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;datetime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-04-17 11:35:15.209&quot;</span>, <span class="token string">&quot;app_name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;dynamic-tp-nacos-cloud-demo&quot;</span>, <span class="token string">&quot;thread_pool_metrics&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;activeCount&quot;</span>:0,<span class="token string">&quot;queueSize&quot;</span>:0,<span class="token string">&quot;largestPoolSize&quot;</span>:100,<span class="token string">&quot;poolSize&quot;</span>:100,<span class="token string">&quot;queueCapacity&quot;</span>:2147483647,<span class="token string">&quot;fair&quot;</span>:false,<span class="token string">&quot;queueTimeoutCount&quot;</span>:0,<span class="token string">&quot;rejectCount&quot;</span>:0,<span class="token string">&quot;waitTaskCount&quot;</span>:0,<span class="token string">&quot;taskCount&quot;</span>:177,<span class="token string">&quot;runTimeoutCount&quot;</span>:0,<span class="token string">&quot;queueRemainingCapacity&quot;</span>:2147483647,<span class="token string">&quot;corePoolSize&quot;</span>:100,<span class="token string">&quot;queueType&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;TaskQueue&quot;</span>,<span class="token string">&quot;completedTaskCount&quot;</span>:177,<span class="token string">&quot;dynamic&quot;</span>:false,<span class="token string">&quot;maximumPoolSize&quot;</span>:400,<span class="token string">&quot;poolName&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;tomcatWebServerTp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="endpoint" tabindex="-1"><a class="header-anchor" href="#endpoint" aria-hidden="true">#</a> endpoint</h3><p>暴露端点(dynamic-tp)，可以通过 http 方式实时请求</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;pool_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;remoting-call&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;core_pool_size&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token property">&quot;maximum_pool_size&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token property">&quot;queue_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SynchronousQueue&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;queue_capacity&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;queue_size&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;fair&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;queue_remaining_capacity&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;active_count&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;task_count&quot;</span><span class="token operator">:</span> <span class="token number">21760</span><span class="token punctuation">,</span>
        <span class="token property">&quot;completed_task_count&quot;</span><span class="token operator">:</span> <span class="token number">21760</span><span class="token punctuation">,</span>
        <span class="token property">&quot;largest_pool_size&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token property">&quot;pool_size&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token property">&quot;wait_task_count&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reject_count&quot;</span><span class="token operator">:</span> <span class="token number">124662</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reject_handler_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallerRunsPolicy&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12),p=[e];function u(i,l){return n(),a("div",null,p)}const r=s(o,[["render",u],["__file","collect_types.html.vue"]]);export{r as default};
